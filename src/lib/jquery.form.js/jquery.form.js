/*!
 * jQuery Form Plugin
 * version: 2.69 (06-APR-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
!function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(r){if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;"function"==typeof r&&(r={success:r});var a=this.attr("action"),n="string"==typeof a?e.trim(a):"";n&&(n=(n.match(/^([^#]+)/)||[])[1]),n=n||window.location.href||"",r=e.extend(!0,{url:n,success:e.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},r);var i={};if(this.trigger("form-pre-serialize",[this,r,i]),i.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(r.beforeSerialize&&!1===r.beforeSerialize(this,r))return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var o,s,l=this.formToArray(r.semantic);if(r.data)for(o in r.extraData=r.data,r.data)if(r.data[o]instanceof Array)for(var c in r.data[o])l.push({name:o,value:r.data[o][c]});else s=r.data[o],s=e.isFunction(s)?s():s,l.push({name:o,value:s});if(r.beforeSubmit&&!1===r.beforeSubmit(l,this,r))return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[l,this,r,i]),i.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var u=e.param(l);"GET"==r.type.toUpperCase()?(r.url+=(r.url.indexOf("?")>=0?"&":"?")+u,r.data=null):r.data=u;var f=this,m=[];if(r.resetForm&&m.push((function(){f.resetForm()})),r.clearForm&&m.push((function(){f.clearForm()})),!r.dataType&&r.target){var d=r.success||function(){};m.push((function(t){var a=r.replaceTarget?"replaceWith":"html";e(r.target)[a](t).each(d,arguments)}))}else r.success&&m.push(r.success);r.success=function(e,t,a){for(var n=r.context||r,i=0,o=m.length;i<o;i++)m[i].apply(n,[e,t,a||f,f])};var p=e("input:file",this).length>0,h="multipart/form-data",v=f.attr("enctype")==h||f.attr("encoding")==h;return!1!==r.iframe&&(p||r.iframe||v)?r.closeKeepAlive?e.get(r.closeKeepAlive,g):g():e.ajax(r),this.trigger("form-submit-notify",[this,r]),this;function g(){var a=f[0];if(e(":input[name=submit],:input[id=submit]",a).length)alert('Error: Form elements must not have name or id of "submit".');else{var n=e.extend(!0,{},e.ajaxSettings,r);n.context=n.context||n;var i="jqFormIO"+(new Date).getTime(),o=e('<iframe id="'+i+'" name="'+i+'" src="'+n.iframeSrc+'" />'),s=o[0];o.css({position:"absolute",top:"-1000px",left:"-1000px"});var l={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){t("aborting upload...");var r="aborted";this.aborted=1,o.attr("src",n.iframeSrc),l.error=r,n.error&&n.error.call(n.context,l,"error",r),c&&e.event.trigger("ajaxError",[l,n,r]),n.complete&&n.complete.call(n.context,l,"error")}},c=n.global;if(c&&!e.active++&&e.event.trigger("ajaxStart"),c&&e.event.trigger("ajaxSend",[l,n]),n.beforeSend&&!1===n.beforeSend.call(n.context,l,n))n.global&&e.active--;else if(!l.aborted){var u=0,m=a.clk;if(m){var d=m.name;d&&!m.disabled&&(n.extraData=n.extraData||{},n.extraData[d]=m.value,"image"==m.type&&(n.extraData[d+".x"]=a.clk_x,n.extraData[d+".y"]=a.clk_y))}n.forceSync?x():setTimeout(x,10);var p,h=50,v=e.parseXML||function(e,t){return window.ActiveXObject?((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},g=e.parseJSON||function(e){return window.eval("("+e+")")},b=function(t,r,a){var n=t.getResponseHeader("content-type")||"",i="xml"===r||!r&&n.indexOf("xml")>=0,o=i?t.responseXML:t.responseText;return i&&"parsererror"===o.documentElement.nodeName&&e.error&&e.error("parsererror"),a&&a.dataFilter&&(o=a.dataFilter(o,r)),"string"==typeof o&&("json"===r||!r&&n.indexOf("json")>=0?o=g(o):("script"===r||!r&&n.indexOf("javascript")>=0)&&e.globalEval(o)),o}}}function x(){var t=f.attr("target"),r=f.attr("action");a.setAttribute("target",i),"POST"!=a.getAttribute("method")&&a.setAttribute("method","POST"),a.getAttribute("action")!=n.url&&a.setAttribute("action",n.url),n.skipEncodingOverride||f.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),n.timeout&&setTimeout((function(){u=!0,y()}),n.timeout);var l=[];try{if(n.extraData)for(var c in n.extraData)l.push(e('<input type="hidden" name="'+c+'" value="'+n.extraData[c]+'" />').appendTo(a)[0]);o.appendTo("body"),s.attachEvent?s.attachEvent("onload",y):s.addEventListener("load",y,!1),a.submit()}finally{a.setAttribute("action",r),t?a.setAttribute("target",t):f.removeAttr("target"),e(l).remove()}}function y(){if(!l.aborted){var r=s.contentWindow?s.contentWindow.document:s.contentDocument?s.contentDocument:s.document;if(r&&r.location.href!=n.iframeSrc||u){s.detachEvent?s.detachEvent("onload",y):s.removeEventListener("load",y,!1);var a=!0;try{if(u)throw"timeout";var i="xml"==n.dataType||r.XMLDocument||e.isXMLDoc(r);if(t("isXml="+i),!i&&window.opera&&(null==r.body||""==r.body.innerHTML)&&--h)return t("requeing onLoad callback, DOM not available"),void setTimeout(y,250);l.responseText=r.body?r.body.innerHTML:r.documentElement?r.documentElement.innerHTML:null,l.responseXML=r.XMLDocument?r.XMLDocument:r,l.getResponseHeader=function(e){return{"content-type":n.dataType}[e]};var f=/(json|script)/.test(n.dataType);if(f||n.textarea){var m=r.getElementsByTagName("textarea")[0];if(m)l.responseText=m.value;else if(f){var d=r.getElementsByTagName("pre")[0],g=r.getElementsByTagName("body")[0];d?l.responseText=d.textContent:g&&(l.responseText=g.innerHTML)}}else"xml"!=n.dataType||l.responseXML||null==l.responseText||(l.responseXML=v(l.responseText));p=b(l,n.dataType,n)}catch(r){t("error caught:",r),a=!1,l.error=r,n.error&&n.error.call(n.context,l,"error",r),c&&e.event.trigger("ajaxError",[l,n,r])}l.aborted&&(t("upload aborted"),a=!1),a&&(n.success&&n.success.call(n.context,p,"success",l),c&&e.event.trigger("ajaxSuccess",[l,n])),c&&e.event.trigger("ajaxComplete",[l,n]),c&&!--e.active&&e.event.trigger("ajaxStop"),n.complete&&n.complete.call(n.context,l,a?"success":"error"),setTimeout((function(){o.removeData("form-plugin-onload"),o.remove(),l.responseXML=null}),100)}}}}},e.fn.ajaxForm=function(r){if(0===this.length){var a={s:this.selector,c:this.context};return!e.isReady&&a.s?(t("DOM not ready, queuing ajaxForm"),e((function(){e(a.s,a.c).ajaxForm(r)})),this):(t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",(function(t){t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(r))})).bind("click.form-plugin",(function(t){var r=t.target,a=e(r);if(!a.is(":submit,input:image")){var n=a.closest(":submit");if(0==n.length)return;r=n[0]}var i=this;if(i.clk=r,"image"==r.type)if(null!=t.offsetX)i.clk_x=t.offsetX,i.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var o=a.offset();i.clk_x=t.pageX-o.left,i.clk_y=t.pageY-o.top}else i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop;setTimeout((function(){i.clk=i.clk_x=i.clk_y=null}),100)}))},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t){var r=[];if(0===this.length)return r;var a,n,i,o,s,l,c,u=this[0],f=t?u.getElementsByTagName("*"):u.elements;if(!f)return r;for(a=0,l=f.length;a<l;a++)if(i=(s=f[a]).name)if(t&&u.clk&&"image"==s.type)s.disabled||u.clk!=s||(r.push({name:i,value:e(s).val()}),r.push({name:i+".x",value:u.clk_x},{name:i+".y",value:u.clk_y}));else if((o=e.fieldValue(s,!0))&&o.constructor==Array)for(n=0,c=o.length;n<c;n++)r.push({name:i,value:o[n]});else null!=o&&r.push({name:i,value:o});if(!t&&u.clk){var m=e(u.clk),d=m[0];(i=d.name)&&!d.disabled&&"image"==d.type&&(r.push({name:i,value:m.val()}),r.push({name:i+".x",value:u.clk_x},{name:i+".y",value:u.clk_y}))}return r},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var r=[];return this.each((function(){var a=this.name;if(a){var n=e.fieldValue(this,t);if(n&&n.constructor==Array)for(var i=0,o=n.length;i<o;i++)r.push({name:a,value:n[i]});else null!=n&&r.push({name:this.name,value:n})}})),e.param(r)},e.fn.fieldValue=function(t){for(var r=[],a=0,n=this.length;a<n;a++){var i=this[a],o=e.fieldValue(i,t);null==o||o.constructor==Array&&!o.length||(o.constructor==Array?e.merge(r,o):r.push(o))}return r},e.fieldValue=function(t,r){var a=t.name,n=t.type,i=t.tagName.toLowerCase();if(void 0===r&&(r=!0),r&&(!a||t.disabled||"reset"==n||"button"==n||("checkbox"==n||"radio"==n)&&!t.checked||("submit"==n||"image"==n)&&t.form&&t.form.clk!=t||"select"==i&&-1==t.selectedIndex))return null;if("select"==i){var o=t.selectedIndex;if(o<0)return null;for(var s=[],l=t.options,c="select-one"==n,u=c?o+1:l.length,f=c?o:0;f<u;f++){var m=l[f];if(m.selected){var d=m.value;if(d||(d=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),c)return d;s.push(d)}}return s}return e(t).val()},e.fn.clearForm=function(){return this.each((function(){e("input,select,textarea",this).clearFields()}))},e.fn.clearFields=e.fn.clearInputs=function(){return this.each((function(){var e=this.type,t=this.tagName.toLowerCase();"text"==e||"password"==e||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t&&(this.selectedIndex=-1)}))},e.fn.resetForm=function(){return this.each((function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()}))},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each((function(){this.disabled=!e}))},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each((function(){var r=this.type;if("checkbox"==r||"radio"==r)this.checked=t;else if("option"==this.tagName.toLowerCase()){var a=e(this).parent("select");t&&a[0]&&"select-one"==a[0].type&&a.find("option").selected(!1),this.selected=t}}))}}(jQuery);
